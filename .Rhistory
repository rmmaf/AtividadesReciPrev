links[2]
tabela[1][2]
tabela[1]
View(tabela)
tabela[[1]][2]
length(tabela[[1]])
length(tabela[[]])
length(tabela)
length(tabela[[1]])
length(tabela[[1]][1])
length(tabela[[1]][2])
tabela[[1]][2]
length(tabela[[1]])
tabela[[1]]
tabela[[2]]
tabela[[1]][2]
tabela[[1]][2][1]
tabela[[1]][[2, 1]]
tabela[[1]][[2, 2]]
tabela[[1]][[1, 1]]
tabela[[1]][["Nome de Pregão"]]
length(tabela[[1]][["Nome de Pregão"]])
library('rvest')
library('httr')
library('xml2')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href") -> links
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
nome
links[1]
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
return(link)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284")
str_replace
library('replace')
library('rvest')
library('httr')
library('xml2')
library('replace')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
return(link)
}
x <- getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284")
x <- sub("../..","http://bvmf.bmfbovespa.com.br",x)
x
library('rvest')
library('httr')
library('xml2')
library('replace')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
return(link)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
return(link)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=16284")
links[5]
library('rvest')
library('httr')
library('xml2')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
links[4]
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
return(link)
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
return(link)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
return(html_nodes(site, 'table'))
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
return(html_nodes(site, 'table')[4])
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
table <- read_html(link) %>% html_nodes(site, 'table')[4] %>% html_table()
return(table)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
table <- read_html(link) %>% html_nodes('table')[4] %>% html_table()
return(table)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
table <- read_html(link) %>% html_nodes('table')[4]
return(table)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
return(html_nodes(site, 'table')[4])
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
return(html_table(html_nodes(site, 'table')[4]))
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
return(tabela)
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
tabela <- html_table(html_nodes(site, 'table')[4])
return(tabela)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
tabela <- html_table(html_nodes(site, 'table')[4])
return(tabela)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")[[1]][1]
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
tabela <- html_table(html_nodes(site, 'table')[4])
return(tabela)
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")[[1]][2, 2]
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
tabela <- html_table(html_nodes(site, 'table')[4])
return(tabela[[1]][2, 2], tabela[[1]][2, 3])
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
library('rvest')
library('httr')
library('xml2')
getValues <- function(url){
source <- read_html(url) %>%
html_nodes('iframe')
link <- html_attr(source, 'src')[2]
link <- sub("../..","http://bvmf.bmfbovespa.com.br",link)
site <- read_html(link)
tabela <- html_table(html_nodes(site, 'table')[4])
return(c(tabela[[1]][2, 2], tabela[[1]][2, 3]))
}
getValues("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/ResumoEmpresaPrincipal.aspx?codigoCvm=22179")
source('~/FinsAcadêmicos/AtividadesReciPrev/webScrap.R', encoding = 'UTF-8')
source('~/FinsAcadêmicos/AtividadesReciPrev/webScrap.R', encoding = 'UTF-8')
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "double", length = 422)
bruto2 <- vector(mode = "double", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
bruto1[i] <- valuesAux[1]
bruto2[i] <- valuesAux[2]
}
View(bruto1)
d <- data.frame(x = 1:4, y= 2:6)
d <- data.frame(x = 1:4, y= 2:5)
d
write.csv(d, row.names = FALSE)
load("~/FinsAcadêmicos/AtividadesReciPrev/.RData")
write.csv(d, file= "teste.csv", row.names = FALSE)
source('~/FinsAcadêmicos/AtividadesReciPrev/webScrap.R', encoding = 'UTF-8')
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "double", length = 422)
bruto2 <- vector(mode = "double", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
bruto1[i] <- valuesAux[1]
bruto2[i] <- valuesAux[2]
}
finalTable <- data.frame("Razão Social" = nome, "Resultado Bruto 2018" = bruto2, "Resultado Bruto 2019" = bruto1)
write.csv(finalTable, file = "TabelaB3.csv", row.names = FALSE)
typeof(bruto1)
typeof(bruto2)
links[20]
links[21]
nome[20]
nome[19]
links[19]
bruto1[19]
as.double(bruto1[19])
finalTable
as.double("1212")
as.double("(1212)")
teste = "(testeteste)"
sub("-", "asdassa", teste)
sub("(", "asdassa", teste)
teste
sub(".", "", teste) %>% sub("(", "-") %>% sub(")", "")
sub(".", "", teste) %>% sub("(", "-", ) %>% sub(")", "", )
sub(".", "", teste) %>% sub("(", "-", teste) %>% sub(")", "", teste)
aux1 <- sub(".", "", teste)
aux1 <- sub("(", "-", aux1)
aux1 <- sub(")", "", aux1)
aux1 <- sub(".", "", teste)
aux1 <- sub("(", "-", aux1)
aux1 <- sub(")", "", aux1)
teste
teste
aux1 <- sub(".", "", teste)
aux1 <- sub("(", "-", aux1)
texte
teste
aux1 <- sub(".", "", teste)
aux1<- sub("(", "-", aux1)
aux1<- sub('(', "-", aux1)
aux1<- sub("(", "-", aux1)
d1 <- "("
aux1<- sub(d1, "-", aux1)
aux2 <- sub(d1, "-", aux1)
aux1
aux1<- sub("(", "-", aux1)
aux1 <- sub(".", "", teste)
aux1
teste
aux1 <- sub(".", "-", teste)
aux1
d1
aux1<- sub("log\\(", "-", aux1)
aux1<- sub("log\\)", "-", aux1)
aux1
aux1<- sub(")", "-", aux1)
aux1
aux1 <- sub(".", "", teste)
teste
aux1
aux1 <- sub("log\\.", "", teste)
aux1
as.numeric("121212")
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "double", length = 422)
bruto2 <- vector(mode = "double", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
aux1 <- sub("log\\.", "", valuesAux[1])
aux1 <- sub("log\\(", "-", aux1)
aux1 <- sub(")", "", aux1)
aux2 <- sub("log\\.", "", valuesAux[2])
aux2 <- sub("log\\(", "-", aux2)
aux2 <- sub(")", "", aux2)
bruto1[i] <- as.numeric(aux1)
bruto2[i] <- as.numeric(aux2)
}
finalTable <- data.frame("Razão Social" = nome, "Resultado Bruto 1" = bruto1, "Resultado Bruto 2" = bruto2)
write.csv(finalTable, file = "TabelaB3.csv", row.names = FALSE)
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "double", length = 422)
bruto2 <- vector(mode = "double", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
aux1 <- sub("log\\.", "", valuesAux[1])
aux1 <- sub("log\\(", "-", aux1)
aux1 <- sub(")", "", aux1)
aux2 <- sub("log\\.", "", valuesAux[2])
aux2 <- sub("log\\(", "-", aux2)
aux2 <- sub(")", "", aux2)
bruto1[i] <- aux1
bruto2[i] <- aux2
}
finalTable <- data.frame("Razão Social" = nome, "Resultado Bruto 1" = bruto1, "Resultado Bruto 2" = bruto2)
write.csv(finalTable, file = "TabelaB3.csv", row.names = FALSE)
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "character", length = 422)
bruto2 <- vector(mode = "character", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
bruto1[i] <- valuesAux[1]
bruto2[i] <- valuesAux[2]
}
finalTable <- data.frame("Razão Social" = nome, "Resultado Bruto 1" = bruto1, "Resultado Bruto 2" = bruto2)
write.csv(finalTable, file = "TabelaB3.csv", row.names = FALSE)
library('rvest')
library('httr')
library('xml2')
source('getter.R')
url <- 'http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/BuscaEmpresaListada.aspx?idioma=pt-br'
request <- POST(url, body = list('__EVENTTARGET' = "ctl00:contentPlaceHolderConteudo:BuscaNomeEmpresa1:btnTodas"), encode = "multipart")
links <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes("tbody tr td a") %>%
xml_attr("href")
links <- unique(links)
tabela <- content(request, as = 'text', encoding = 'utf-8') %>%
read_html() %>%
html_nodes('table') %>%
html_table()
nome <- tabela[[1]][["Razão Social"]]
bruto1 <- vector(mode = "character", length = 422)
bruto2 <- vector(mode = "character", length = 422)
for (i in 1:422) {
valuesAux <- getValues(paste0("http://bvmf.bmfbovespa.com.br/cias-listadas/empresas-listadas/", links[i]))
bruto1[i] <- valuesAux[1]
bruto2[i] <- valuesAux[2]
}
finalTable <- data.frame("Razão Social" = nome, "Resultado Bruto 1" = bruto1, "Resultado Bruto 2" = bruto2)
write.csv(finalTable, file = "TabelaB3.csv", row.names = FALSE)
